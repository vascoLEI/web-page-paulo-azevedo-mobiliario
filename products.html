<!DOCTYPE html>
<html lang="pt">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Produtos | Paulo Azevedo Mobiliário</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="logoicon.png">
</head>

<body>
  <header>
    <nav class="navbar">
      <h1 class="logo">
        <a href="index.html">
          <img src="images/Logo.png" alt="Paulo Azevedo Mobiliário" class="logo-img">
        </a>
      </h1>

      <button class="nav-toggle" aria-label="Abrir menu">
        ☰
      </button>

      <ul class="nav-links">
        <li><a href="products.html">Produtos</a></li>
        <li><a href="about.html">Sobre nós</a></li>
        <li><a href="contacts.html">Contactos</a></li>
      </ul>
    </nav>
  </header>

  <section class="produtos-page">
    <div class="produtos-header">
      <h2>Os nossos produtos</h2>
      <p>Alguns exemplos de mobiliário, estofos e colchões disponíveis na loja.</p>
    </div>

    <div class="filtros-wrapper">
      <div class="filtros">
        <button class="filtro-btn active" data-filter="all">Todos</button>
        <button class="filtro-btn" data-filter="sala">Salas</button>
        <button class="filtro-btn" data-filter="quarto">Quartos</button>
        <button class="filtro-btn" data-filter="colchao">Colchões</button>
        <button class="filtro-btn" data-filter="decoracao">Decoração</button>
        <button class="filtro-btn" data-filter="aparador">Aparadores</button>
        <button class="filtro-btn" data-filter="sofa">Sofás</button>
      </div>
    </div>

    <div class="produtos-grid-page" id="produtos-grid"></div>
  </section>

  <footer>
    <p>&copy; 2025 Paulo Azevedo Mobiliário</p>
  </footer>

  <!-- Lightbox container for enlarged product images -->
  <div class="lightbox" id="lightbox-produto">
    <img src="" alt="Produto ampliado">
  </div>

  <!-- Provides the product list -->
  <script src="listOfProducts.js"></script>

  <!-- Renders the products into the grid using the PRODUCTS array -->
  <script>
    // Renders the products into the grid based on the given list
    function renderProducts(list) {
      const grid = document.getElementById('produtos-grid');
      if (!grid) return;

      grid.innerHTML = list.map(p => `
        <article class="produto-card" data-categoria="${p.categoria}">
          <img src="${p.imagem}" alt="${p.nome}">
          <h3>${p.nome}</h3>
          <p>${p.descricao || ""}</p>
        </article>
      `).join('');
    }
  </script>

  <!-- Sets up the filter buttons to show/hide products by category -->
  <script>
    // Initializes the category filter buttons
    function initFilters() {
      const filterButtons = document.querySelectorAll(".filtro-btn");

      filterButtons.forEach(btn => {
        btn.addEventListener("click", () => {
          const filter = btn.dataset.filter;
          const products = document.querySelectorAll(".produto-card");

          filterButtons.forEach(b => b.classList.remove("active"));
          btn.classList.add("active");

          products.forEach(prod => {
            const category = prod.dataset.categoria;
            if (filter === "all" || category === filter) {
              prod.style.display = "block";
            } else {
              prod.style.display = "none";
            }
          });
        });
      });
    }
  </script>

  <!-- Shrinks the header slightly when the user scrolls down -->
  <script>
    // Adds or removes the 'header-small' class depending on scroll position
    function setupHeaderShrink() {
      const header = document.querySelector('header');
      if (!header) return;

      window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
          header.classList.add('header-small');
        } else {
          header.classList.remove('header-small');
        }
      });
    }
  </script>

  <!-- Toggles the mobile navigation menu -->
  <script>
    // Sets up click listener to open/close the mobile nav links
    function setupMobileMenu() {
      const toggle = document.querySelector('.nav-toggle');
      const navLinks = document.querySelector('.nav-links');
      if (!toggle || !navLinks) return;

      toggle.addEventListener('click', () => {
        navLinks.classList.toggle('open');
      });
    }
  </script>

  <!-- Handles the product image lightbox for this page -->
  <script>
    // Initializes the lightbox behaviour for product images
    function initProductLightbox() {
      const lightbox = document.getElementById('lightbox-produto');
      if (!lightbox) return;

      const lightboxImg = lightbox.querySelector('img');

      // Attach click listeners to each product image
      function attachImageListeners() {
        const productImages = document.querySelectorAll('.produto-card img');

        productImages.forEach(img => {
          img.addEventListener('click', () => {
            lightboxImg.src = img.src;
            lightbox.style.display = 'flex';
            document.body.classList.add('lightbox-open');
          });
        });
      }

      // Closes the lightbox and resets image
      function closeProductLightbox() {
        lightbox.style.display = 'none';
        lightboxImg.src = '';
        document.body.classList.remove('lightbox-open');
      }

      // Close when clicking outside the image
      lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox) {
          closeProductLightbox();
        }
      });

      // Close on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          closeProductLightbox();
        }
      });

      attachImageListeners();
    }

    // Initialize all behaviours after the page is loaded
    window.addEventListener('load', () => {
      renderProducts(PRODUCTS);
      initFilters();
      setupHeaderShrink();
      setupMobileMenu();
      initProductLightbox();
    });
  </script>

</body>

</html>
